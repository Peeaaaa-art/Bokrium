<div
  id="<%= dom_id(memo) %>"
  class="card memo-display position-relative mb-3"
  data-controller="memo-modal"
  data-action="click->memo-modal#open"
  data-memo-modal-memo-id-value="<%= memo.id || 'new' %>"
  data-memo-modal-book-id-value="<%= book.id %>"
  data-memo-modal-initial-content-value="<%= memo.content || "" %>"
>

  <!-- üìå ÂÖ¨Èñã„ÉªÂâäÈô§„Å™„Å©„ÅÆ„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ -->
  <% unless memo.new_record? %>
    <div class="dropdown position-absolute top-0 end-0 m-2" data-action="click->memo-modal#stop">
      <button class="btn btn-sm btn-light" data-bs-toggle="dropdown" aria-expanded="false">
        ‚ãØ
      </button>
      <ul class="dropdown-menu dropdown-menu-end">
        <li>
          <%= form_with model: [book, memo], method: :patch, data: { turbo_confirm: "ÂÖ¨ÈñãË®≠ÂÆö„ÇíÂàá„ÇäÊõø„Åà„Åæ„Åô„ÅãÔºü" } do |f| %>
            <%= f.hidden_field :content, value: memo.content %>
            <%= f.hidden_field :published, value: memo.published == "you_can_see" ? "only_i_can_see" : "you_can_see" %>
            <button type="submit" class="dropdown-item">
              <i class="bi <%= memo.published == "you_can_see" ? "bi-eye-slash" : "bi-eye text-success" %> me-1"></i>
              <%= memo.published == "only_i_can_see" ? "ÂÖ¨Èñã„Åô„Çã" : "ÈùûÂÖ¨Èñã„Å´„Åô„Çã" %>
            </button>
          <% end %>
        </li>
        <li>
          <%= button_to book_memo_path(book, memo),
                        method: :delete,
                        data: {
                          turbo: true,
                          turbo_confirm: "„Åì„ÅÆ„É°„É¢„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü"
                        },
                        form: { data: { turbo_stream: true } },
                        class: "dropdown-item text-danger" do %>
            <i class="bi bi-trash me-1"></i> ÂâäÈô§„Åô„Çã
          <% end %>
        </li>
      </ul>
    </div>
  <% end %>

  <!-- „Éò„ÉÉ„ÉÄ„Éº -->
  <div class="card-header bg-rhodia-orange d-flex justify-content-center py-2">
    <i class="bi bi-cloud-fog2-fill"></i>
    <i class="bi bi-cloud-haze2"></i>
    <i class="bi bi-cloud-fog2-fill"></i>
  </div>

  <!-- ÂÜÖÂÆπ -->
  <div class="card-body rhodia-grid-bg memo-readonly">
    <%= memo.content&.html_safe.presence || memo_placeholder_html %>
  </div>
  <!-- „Çπ„ÉÜ„Éº„Çø„Çπ„Ç¢„Ç§„Ç≥„É≥ÔºàÂè≥‰∏ã„Å´ÊµÆ„Åã„Åõ„ÇãÔºâ -->
  <% if memo.persisted? %>
    <div class="position-absolute bottom-0 end-0 m-2" style="z-index: 1;">
      <i class="bi <%= memo.published == "you_can_see" ? "bi-eye text-success" : "bi-eye-slash text-muted" %>"
        title="<%= memo.published == "you_can_see" ? "ÂÖ¨Èñã‰∏≠" : "ÈùûÂÖ¨Èñã" %>"></i>
    </div>
  <% end %>
</div>