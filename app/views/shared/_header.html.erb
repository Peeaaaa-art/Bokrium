<nav class="navbar navbar-expand-lg navbar-dark rhodia-gray shadow-sm">
  <div class="container-fluid px-md-5 px-4">
    
    <!-- ロゴ -->
    <%= link_to "Bokrium", root_path,
          class: "text-light navbar-brand fw-bold text-primary big-shoulders-inline-bold logo-link",
          style: "font-size: 3.5rem;" %>

    <!-- ✅ スマホ用: ユーザー + ハンバーガー（右上） -->
    <div class="d-flex d-lg-none align-items-center ms-auto gap-2">
      <div class="pe-3">
        <% if user_signed_in? %>
          <%= link_to user_path(current_user) do %>
            <%= image_tag user_avatar(current_user, size: :small), alt: current_user.name, class: "avatar-circle-mini" %>
          <% end %>
        <% else %>
          <%= link_to t('devise.sessions.new.sign_in', default: 'ログイン'), new_user_session_path, class: 'btn btn-sm btn-primary' %>
        <% end %>
      </div>

      <!-- ハンバーガーボタン -->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>

    <!-- ナビゲーションとユーザー -->
    <div class="collapse navbar-collapse justify-content-between" id="mainNavbar">
      <ul class="navbar-nav text-end mx-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <%= nav_link_to root_path do %>
            <i data-lucide="home" class="me-1"></i>
            <%= t('nav.home', default: 'ホーム') %>
          <% end %>
        </li>
        <li class="nav-item">
          <%= nav_link_to books_path do %>
            <i data-lucide="library" class="me-1"></i>
            <%= t('nav.service', default: 'My本棚') %>
          <% end %>
        </li>
        <li class="nav-item">
          <%= nav_link_to search_books_path do %>
            <i data-lucide="search" class="me-1"></i>
            <%= t('nav.portfolio', default: '書籍検索') %>
          <% end %>
        </li>
        <li class="nav-item">
          <%= nav_link_to "#" do %>
            <i data-lucide="users" class="me-1"></i>
            <%= t('nav.price', default: 'みんなの本棚') %>
          <% end %>
        </li>
      </ul>

      <div class="p-3">
        <i data-lucide="search"></i>
        <i data-lucide="book-open"></i>
        <i data-lucide="users"></i>
      </div>

      <!-- PC用：ユーザーアイコンまたは認証ボタン -->
      <div class="d-none d-lg-flex align-items-center gap-2 ms-lg-3">
        <% if user_signed_in? %>
          <%= link_to user_path(current_user) do %>
            <%= image_tag user_avatar(current_user, size: :small), alt: current_user.name, class: "avatar-circle-mini" %>
          <% end %>
        <% else %>
          <%= link_to t('devise.sessions.new.sign_in', default: 'ログイン'), new_user_session_path, class: 'btn btn-primary' %>
          <%= link_to t('devise.registrations.new.sign_up', default: '新規登録'), new_user_registration_path, class: 'btn btn-success' %>
        <% end %>
      </div>
    </div>

  </div>
</nav>