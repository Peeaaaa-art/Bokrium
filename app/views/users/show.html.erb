<% content_for :title, "ユーザー - Bokrium" %>

<% if current_user.cancel_at_period_end? && current_user.current_period_end.present? %>
  <div class="alert alert-warning text-center">
    <span class="fw-semibold big-shoulders-inline-bold fs-5" style="letter-spacing: 0.03em;">Bokrium+</span> は <%= current_user.current_period_end.strftime("%Y年%m月%d日") %> に終了予定です。
  </div>
<% elsif current_user.cancel_at_period_end? %>
  <div class="alert alert-warning text-center">
    <span class="fw-semibold big-shoulders-inline-bold fs-5" style="letter-spacing: 0.03em;">Bokrium+</span> は現在の請求期間終了後にキャンセルされます。
  </div>
<% end %>

<% if current_user %>
  <div class="container my-5">
    <div class="card subtle-shadow mb-4">
      <div class="card-header bg-rhodia-blue text-white d-flex justify-content-between align-items-center">
        <span class="fs-5">マイページ</span>
            <%= link_to (current_user.subscribed_user? ? "#" : plans_path), class: "btn btn-warning shadow-sm d-inline-flex align-items-center gap-2 px-4 py-1 rounded-pill" do %>
              <i class="bi bi-gem fs-5"></i>
              <span class="fw-semibold big-shoulders-inline-bold fs-4" style="letter-spacing: 0.03em;">Bokrium+</span>
            <% end %>
      </div>

      <div class="card-body bg-light-bok">
        <div class="row align-items-center">
          <div class="col-md-3 text-center">
            <%= image_tag user_avatar(current_user, size: :large), alt: current_user.name, class: "avatar-circle mb-3" %>
          </div>
          <div class="col-md-9">
            <ul class="list-group list-group-flush">
              <li class="list-group-item">
                <strong><%= User.human_attribute_name(:name) %>:</strong>
                <span class="ms-2"><%= current_user.name %></span>
              </li>
              <li class="list-group-item">
                <strong><%= User.human_attribute_name(:email) %>:</strong>
                <span class="ms-2"><%= current_user.email %></span>
              </li>
              <li class="list-group-item">
                <strong><%= t('users.show.registered_at', default: '登録日') %>:</strong>
                <span class="ms-2"><%= l(current_user.created_at, format: :only_date) %></span>
              </li>
              <li class="list-group-item">
                <strong>現在のプラン:</strong>
                <span class="ms-2">
                  <%= current_user.subscribed_user? ? "Bokrium+" : "無料プラン" %>
                </span>
              </li>
            </ul>
            <div class="d-flex justify-content-left gap-2 mt-3" data-controller="safari-click-fix">
              <%= link_to '編集', edit_user_registration_path(current_user), class: "btn btn-outline-primary safari-fix-button" %>
              <%= link_to t('devise.sessions.signed_in.sign_out', default: 'ログアウト'),
                    destroy_user_session_path,
                    data: { turbo_method: :delete, turbo_confirm: "本当にログアウトしますか？" },
                    class: 'btn btn-danger safari-fix-button safari-modal-action-button' %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
<% end %>



<%= render "shared/line_settings" %>