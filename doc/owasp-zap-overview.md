## OWASP ZAP とは何か

**OWASP ZAP**（オワスプ・ザップ）は、**Web アプリケーションのセキュリティを調べるためのツール**です。

- **OWASP** … オープンソースのセキュリティに関する国際的な非営利団体。Web アプリの脆弱性リスト（OWASP Top 10）などで知られています。
- **ZAP** … Zed Attack Proxy の略。**実際に動いている Web サイトやアプリにアクセスし、レスポンスの内容や設定をチェックする**ソフトウェアです。

つまり、

- **ソースコードだけを読んでチェックする**のではなく、
- **実際に動かしているアプリに「ブラウザやツールがアクセスしたとき」に、どんな応答が返るか**を確認する

ためのツールです。

### よく出てくる用語

- **DAST**（ダスト）… Dynamic Application Security Testing の略。「動いているアプリに対して行うセキュリティテスト」という意味です。ZAP は DAST の一種です。
- **パッシブスキャン** … アプリに**攻撃を送らず**、返ってきたレスポンス（ヘッダーや Cookie の設定など）を**読んでチェックする**だけの検査です。ZAP の Baseline Scan は主にこの方式です。

---

## なぜ導入するのか

### コードのチェックだけでは見えないことがある

プログラムの**中身（ソースコード）**を解析するツール（Brakeman や CodeQL など）では、

- コードの書き方のミス
- 既知の脆弱性を持ったライブラリの使用

といった問題は検出できます。

一方で、**実際に Web として公開したときにどう振る舞うか**は、コードだけでは分からない部分があります。

例として、次のようなものがあります。

- **セキュリティヘッダー** … ブラウザに「このページをこう扱ってほしい」と伝える設定。設定し忘れや誤りがあると、想定外の表示や挙動の原因になることがあります。
- **Cookie の設定** … ログイン状態などを保持する Cookie に、適切なオプション（暗号化の強さや有効期限など）が付いているか。
- **Content-Type など** … 返すデータの種類が正しく宣言されているか。

これらは**「動いているアプリが実際に返している内容」**を見ないと分かりません。ZAP は、その「実際に返している内容」を自動で確認してくれます。

### このプロジェクトで ZAP を導入する目的

このプロジェクト（Bokrium）では、ZAP の **Baseline Scan** を次の目的で使っています。

1. **本番前に気づく**  
   本番環境を触らず、**テスト用の環境でだけ**アプリを起動し、その環境に対して ZAP を実行します。  
   セキュリティヘッダーや Cookie の設定ミスを、**リリース前の段階で**発見する助けにします。

2. **変更による「戻り」を防ぐ**  
   一度正しく設定したつもりでも、後の変更で設定が外れたり書き換わったりすることがあります。  
   ZAP を定期的（または必要なタイミングで）実行することで、**以前は問題なかったのに、いまは問題になっている**といった**退行**に気づきやすくします。

3. **負荷とリスクを抑える**  
   本番のサーバーにはアクセスせず、テスト環境だけを対象にします。  
   また、Baseline Scan は**パッシブ**が中心なので、アプリに攻撃的なリクエストを送りつけるようなことはしません。  
   そのため、**「本番に影響を与えず、安全にチェックする」**という使い方ができます。

### 何をカバーし、何をカバーしないか

- **カバーする** … 実際に返しているレスポンスの内容（ヘッダー・Cookie など）のチェック。設定の抜けや誤りの**気づき**と、変更による**退行の検知**の補助。
- **カバーしない** … コードのバグや SQL インジェクション・XSS などの攻撃検知は、別のツール（Brakeman や CodeQL など）が担います。ZAP の Baseline はそれらの**代替ではなく、補い**として使っています。

---

## まとめ

| 項目 | 内容 |
|------|------|
| **OWASP ZAP とは** | 動いている Web アプリにアクセスし、返ってくる内容（ヘッダー・Cookie など）をチェックするセキュリティツール（DAST の一種）。 |
| **なぜ導入するか** | コード解析だけでは分からない「実際の応答の設定」を確認し、本番前に問題に気づいたり、変更による退行を防いだりするため。 |
| **このプロジェクトでの使い方** | テスト環境だけを対象に、手動で ZAP の Baseline Scan を実行。本番は叩かず、ヘッダー・Cookie などの退行検知の補助として利用。 |


